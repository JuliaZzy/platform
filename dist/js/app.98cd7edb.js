(function(){"use strict";var t={4144:function(t,e,a){var s=a(5471),i=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},r=[],n={name:"App"},o=n,l=a(1656),c=(0,l.A)(o,i,r,!1,null,null,null),d=c.exports,u=a(173),h=function(){var t=this,e=t._self._c;return e("div",{staticClass:"page-container"},[e("LoadingSpinner",{attrs:{visible:t.isLoading}}),t._m(0),e("div",{staticClass:"admin"},[e("button",{staticClass:"admin-login-button",on:{click:t.openLoginModal}},[t._v("ç®¡ç†å‘˜ç™»å½•")])]),t.isLoginModalVisible?e("div",{staticClass:"login-modal"},[e("div",{staticClass:"modal-content"},[e("LoginForm",{on:{"login-success":t.handleLoginSuccess}}),e("button",{staticClass:"login-close-button",on:{click:t.closeLoginModal}},[t._v("å…³é—­")])],1)]):t._e(),e("div",{staticClass:"status-row"},t._l(t.labels,(function(a,s){return e("div",{key:s,staticClass:"status-box",class:{clickable:"éä¸Šå¸‚å…¬å¸å…¥è¡¨"===a||"ä¸Šå¸‚å…¬å¸å…¥è¡¨"===a},on:{click:function(e){return t.handleStatusBoxClick(a)}}},[e("h3",[t._v("æˆªè‡³"+t._s(t.currentMonth))]),e("p",{staticClass:"status-title"},[t._v(t._s(a))]),e("p",{staticClass:"status-number"},[t._v(" "+t._s("ä¸Šå¸‚å…¬å¸å…¥è¡¨"===a?t.listedCompanyCount:"éä¸Šå¸‚å…¬å¸å…¥è¡¨"===a?t.nonListedCompanyCount:"å‡­æ•°æ®èµ„äº§èèµ„"===a?t.financeCompanyCount:"æš‚æ— æ•°æ®")+" å®¶ ")]),"éä¸Šå¸‚å…¬å¸å…¥è¡¨"===a||"ä¸Šå¸‚å…¬å¸å…¥è¡¨"===a?e("div",{staticClass:"status-note"},[t._v("ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…")]):t._e()])})),0),t._m(1),e("div",{staticClass:"grid-container"},[e("div",{staticClass:"grid-item"},[e("div",{staticClass:"table-wrapper"},[e("ChartSpinner",{attrs:{visible:t.isFirstTableLoading}}),e("table",[t._m(2),t._m(3),t._l(t.quarterTableMaxRows,(function(a){return e("tr",{key:a},[e("td",[t._v(t._s(t.pagedQ1[a-1]||""))]),e("td",[t._v(t._s(t.pagedQ2[a-1]||""))]),e("td",[t._v(t._s(t.pagedQ3[a-1]||""))]),e("td",[t._v(t._s(t.pagedQ4[a-1]||""))])])})),t.quarterTablePages>1?e("tr",[e("td",{attrs:{colspan:"4"}},[e("div",{staticClass:"pagination"},[e("button",{attrs:{disabled:1===t.quarterTablePage},on:{click:function(e){t.quarterTablePage--}}},[t._v("ä¸Šä¸€é¡µ")]),e("span",[t._v(t._s(t.quarterTablePage)+" / "+t._s(t.quarterTablePages))]),e("button",{attrs:{disabled:t.quarterTablePage===t.quarterTablePages},on:{click:function(e){t.quarterTablePage++}}},[t._v("ä¸‹ä¸€é¡µ")])])])]):t._e()],2)],1)]),e("div",{staticClass:"grid-item"},[e("div",{staticClass:"table-wrapper"},[e("ChartSpinner",{attrs:{visible:t.isSecondTableLoading}}),e("table",[t._m(4),t._l(t.nonListedCompanies,(function(a,s){return e("tr",{key:s},[e("td",{domProps:{textContent:t._s(a.company_name)}})])})),t.secondTablePages>1?e("tr",[e("td",{attrs:{colspan:"2"}},[e("div",{staticClass:"pagination"},[e("button",{attrs:{disabled:1===t.secondTablePage},on:{click:function(e){return t.changePage("secondTable",t.secondTablePage-1)}}},[t._v("ä¸Šä¸€é¡µ")]),e("span",[t._v(t._s(t.secondTablePage)+" / "+t._s(t.secondTablePages))]),e("button",{attrs:{disabled:t.secondTablePage===t.secondTablePages},on:{click:function(e){return t.changePage("secondTable",t.secondTablePage+1)}}},[t._v("ä¸‹ä¸€é¡µ")])])])]):t._e()],2)],1)]),e("div",{staticClass:"grid-item"},[e("div",{staticClass:"table-wrapper"},[e("ChartSpinner",{attrs:{visible:!1}}),e("table",[t._m(5),t._l(t.pagedFinancingCompanies,(function(a,s){return e("tr",{key:s},[e("td",[t._v(t._s(a))])])})),t.thirdTablePages>1?e("tr",[e("td",{attrs:{colspan:"2"}},[e("div",{staticClass:"pagination"},[e("button",{attrs:{disabled:1===t.thirdTablePage},on:{click:function(e){return t.changePage("thirdTable",t.thirdTablePage-1)}}},[t._v("ä¸Šä¸€é¡µ")]),e("span",[t._v(t._s(t.thirdTablePage)+" / "+t._s(t.thirdTablePages))]),e("button",{attrs:{disabled:t.thirdTablePage===t.thirdTablePages},on:{click:function(e){return t.changePage("thirdTable",t.thirdTablePage+1)}}},[t._v("ä¸‹ä¸€é¡µ")])])])]):t._e()],2)],1)])]),t._m(6)],1)},p=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"header"},[e("img",{attrs:{src:a(8305),alt:"Header Image"}}),e("div",{staticClass:"header-content"},[e("div",{staticClass:"left"},[e("h1",[t._v("ä¸­å›½ä¼ä¸šæ•°æ®èµ„äº§"),e("br"),t._v("å…¥è¡¨è·Ÿè¸ª")]),e("p",[t._v("Discover the Power of "),e("br"),t._v("Partnership for Sustainable Water Solutions")])])])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"table-header-container"},[e("div",{staticClass:"table-header"},[e("i",{staticClass:"fas fa-list"}),t._v(" "),e("span",[t._v("æ¦œå•")])])])},function(){var t=this,e=t._self._c;return e("tr",[e("th",{attrs:{colspan:"4"}},[t._v("ä¸Šå¸‚å…¬å¸å…¥è¡¨æ¸…å•")])])},function(){var t=this,e=t._self._c;return e("tr",[e("th",[t._v("2024Q1")]),e("th",[t._v("2024Q2")]),e("th",[t._v("2024Q3")]),e("th",[t._v("2024Q4")])])},function(){var t=this,e=t._self._c;return e("tr",[e("th",{attrs:{colspan:"2"}},[t._v("éä¸Šå¸‚å…¬å¸å…¥è¡¨æ¸…å•")])])},function(){var t=this,e=t._self._c;return e("tr",[e("th",{attrs:{colspan:"2"}},[t._v("æ•°æ®èµ„äº§èèµ„ä¼ä¸šæ¸…å•")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"footer"},[e("div",{staticClass:"footer-overlay"}),e("img",{staticClass:"footer-bg",attrs:{src:a(8547),alt:"Footer Image"}}),e("div",{staticClass:"footer-content"},[e("a",{attrs:{href:""}},[t._v("è”ç³»æˆ‘ä»¬")]),e("a",{attrs:{href:""}},[t._v("åé¦ˆæ„è§/ç”³æŠ¥")])])])}],m=(a(4114),a(8111),a(2489),a(1701),a(4335)),f=function(){var t=this,e=t._self._c;return e("div",{staticClass:"login-form"},[e("h2",{staticClass:"title"},[t._v("ç®¡ç†å‘˜ç™»å½•")]),t._v(" "),e("div",{staticClass:"input-group"},[e("label",{attrs:{for:"username"}},[t._v("ç”¨æˆ·å")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],attrs:{type:"text",id:"username",placeholder:"è¯·è¾“å…¥ç”¨æˆ·å"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),e("div",{staticClass:"input-group"},[e("label",{attrs:{for:"password"}},[t._v("å¯†ç ")]),t._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],attrs:{type:"password",id:"password",placeholder:"è¯·è¾“å…¥å¯†ç "},domProps:{value:t.password},on:{input:function(e){e.target.composing||(t.password=e.target.value)}}})]),e("button",{on:{click:t.handleLogin}},[t._v("ç™»å½•")]),t.errorMessage?e("p",{staticStyle:{color:"red"}},[t._v(t._s(t.errorMessage))]):t._e()])},g=[],v={name:"LoginForm",data(){return{username:"",password:"",errorMessage:""}},methods:{handleLogin(){this.username&&this.password?m.A.post("/api/login",{username:this.username,password:this.password},{headers:{"Content-Type":"application/json"}}).then((t=>{t.data.success?(localStorage.setItem("adminLoggedIn","true"),this.$emit("login-success")):this.errorMessage="ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯"})).catch((t=>{console.error("ç™»å½•å¤±è´¥:",t),this.errorMessage="ç™»å½•å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•"})):this.errorMessage="ç”¨æˆ·åå’Œå¯†ç ä¸èƒ½ä¸ºç©º"}}},b=v,_=(0,l.A)(b,f,g,!1,null,"05bb0d88",null),y=_.exports,C=function(){var t=this,e=t._self._c;return t.visible?e("div",{staticClass:"spinner-container"},[e("div",{staticClass:"spinner"},t._l(8,(function(a){return e("div",{key:a,staticClass:"spinner-dot",style:t.getStyle(a)})})),0)]):t._e()},w=[],S={name:"LoadingSpinner",props:{visible:{type:Boolean,default:!1}},methods:{getStyle(t){const e=45*(t-1);return{transform:`rotate(${e}deg) translate(0, -12px)`}}}},x=S,T=(0,l.A)(x,C,w,!1,null,"25df46fa",null),P=T.exports,D=function(){var t=this,e=t._self._c;return t.visible?e("div",{staticClass:"chart-spinner-container"},[e("div",{staticClass:"spinner"},t._l(8,(function(a){return e("div",{key:a,staticClass:"spinner-dot",style:t.getStyle(a)})})),0)]):t._e()},k=[],L={name:"ChartSpinner",props:{visible:{type:Boolean,default:!1}},methods:{getStyle(t){const e=45*(t-1);return{transform:`rotate(${e}deg) translate(0, -12px)`}}}},A=L,F=(0,l.A)(A,D,k,!1,null,"47c0128b",null),O=F.exports,j={name:"App",components:{LoginForm:y,LoadingSpinner:P,ChartSpinner:O},data(){return{isLoading:!0,isFirstTableLoading:!1,isSecondTableLoading:!1,currentMonth:"",labels:["ä¸Šå¸‚å…¬å¸å…¥è¡¨","éä¸Šå¸‚å…¬å¸å…¥è¡¨","å‡­æ•°æ®èµ„äº§èèµ„"],listedCompanyCount:0,nonListedCompanyCount:0,financeCompanyCount:0,listedQ1:[],listedQ2:[],listedQ3:[],listedQ4:[],quarterTablePage:1,quarterTablePages:1,quarterTableMaxRows:10,nonListedCompanies:[],secondTablePage:1,secondTablePages:1,financingCompanies:[],thirdTablePage:1,thirdTablePages:1,isLoginModalVisible:!1}},computed:{pagedQ1(){const t=(this.quarterTablePage-1)*this.quarterTableMaxRows;return this.listedQ1.slice(t,t+this.quarterTableMaxRows)},pagedQ2(){const t=(this.quarterTablePage-1)*this.quarterTableMaxRows;return this.listedQ2.slice(t,t+this.quarterTableMaxRows)},pagedQ3(){const t=(this.quarterTablePage-1)*this.quarterTableMaxRows;return this.listedQ3.slice(t,t+this.quarterTableMaxRows)},pagedQ4(){const t=(this.quarterTablePage-1)*this.quarterTableMaxRows;return this.listedQ4.slice(t,t+this.quarterTableMaxRows)},pagedFinancingCompanies(){const t=this.financingCompanies||[],e=10*(this.thirdTablePage-1);return t.slice(e,e+10)}},mounted(){const t=new Date,e=t.getFullYear(),a=String(t.getMonth()+1).padStart(2,"0");this.currentMonth=`${e}å¹´${a}æœˆ`,this.loadAllData()},methods:{async loadAllData(){console.log("âœ… financingCompanies",this.financingCompanies),console.log("âœ… financeCompanyCount",this.financeCompanyCount),console.log("âœ… pagedFinancingCompanies",this.pagedFinancingCompanies),this.isLoading=!0;try{const t=await m.A.get("/api/company/homepage-summary"),e=t.data;this.listedCompanyCount=e.listedCompanyCount,this.nonListedCompanyCount=e.nonListedCompanyCount,this.financeCompanyCount=e.financeCompanyCount,this.financingCompanies=e.financingCompanies,this.thirdTablePages=Math.ceil(e.financeCompanyCount/10);const a=e.listedCompanies||[];this.listedQ1=a.filter((t=>"Q1"===t["æŠ¥å‘Šæ—¶é—´"])).map((t=>t["å…¬å¸"])),this.listedQ2=a.filter((t=>"Q2"===t["æŠ¥å‘Šæ—¶é—´"])).map((t=>t["å…¬å¸"])),this.listedQ3=a.filter((t=>"Q3"===t["æŠ¥å‘Šæ—¶é—´"])).map((t=>t["å…¬å¸"])),this.listedQ4=a.filter((t=>"Q4"===t["æŠ¥å‘Šæ—¶é—´"])).map((t=>t["å…¬å¸"]));const s=Math.max(this.listedQ1.length,this.listedQ2.length,this.listedQ3.length,this.listedQ4.length);this.quarterTablePages=Math.ceil(s/this.quarterTableMaxRows),this.nonListedCompanies=e.nonListedCompanies,this.secondTablePages=Math.ceil(e.nonListedCompanyCount/10)}catch(t){console.error("åŠ è½½æ•°æ®å‡ºé”™ï¼š",t)}finally{this.isLoading=!1}},async changePage(t,e){if(!(e<1||e>this[`${t}Pages`])){this[`${t}Page`]=e;try{if("secondTable"===t){this.isSecondTableLoading=!0;const t=await m.A.get(`/api/company/non-listed-companies?page=${e}`);this.nonListedCompanies=t.data.data}else"thirdTable"===t&&(this.thirdTablePage=e)}catch(a){console.error("åˆ†é¡µåŠ è½½å¤±è´¥:",a)}finally{"secondTable"===t&&(this.isSecondTableLoading=!1)}}},openLoginModal(){this.isLoginModalVisible=!0},closeLoginModal(){this.isLoginModalVisible=!1},handleLoginSuccess(){this.closeLoginModal(),this.$router.push("/admin-page")},handleStatusBoxClick(t){"éä¸Šå¸‚å…¬å¸å…¥è¡¨"===t?this.$router.push("/dashboard"):"ä¸Šå¸‚å…¬å¸å…¥è¡¨"===t&&this.$router.push("/lsdashboard")}}},$=j,q=(0,l.A)($,h,p,!1,null,"3d73b8c0",null),N=q.exports,R=function(){var t=this,e=t._self._c;return e("div",{staticClass:"dashboard-page"},[e("LoadingSpinner",{attrs:{visible:t.isLoading}}),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],staticClass:"dashboard-title-block"},[e("h1",{staticClass:"dashboard-title"},[t._v("éä¸Šå¸‚å…¬å¸æ•°æ®èµ„äº§æƒ…å†µ")]),e("p",{staticClass:"dashboard-subtitle"},[t._v("Overview of Non-listed Company Data Assets")])]),e("FilterSection",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],attrs:{apiPrefix:"/api/nlasset",options:t.options,filters:t.pendingFilters},on:{"filter-change":t.handleFilterChange}}),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],staticClass:"dashboard-container"},[e("ChartRow",{attrs:{filters:t.filters,mode:"nls",charts:t.charts}}),e("DataTable",{ref:"dataTable",attrs:{filters:t.filters,tableData:t.currentPageData,totalRows:t.totalRows,apiPrefix:"/api/nlasset"},on:{"page-change":t.handlePageChange}})],1)],1)},M=[],E=function(){var t=this,e=t._self._c;return e("div",{staticClass:"filter-section"},[e("div",{staticClass:"filter-row"},[e("div",{staticClass:"filter-item"},[e("label",[t._v("å…¥è¡¨æ—¶é—´ï¼š")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.startDate,expression:"startDate"}],on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.startDate=e.target.multiple?a:a[0]}}},[e("option",{attrs:{value:""}},[t._v("å¼€å§‹æ—¶é—´")]),t._l(t.options.month_time,(function(a){return e("option",{key:a,domProps:{value:a}},[t._v(t._s(a))])}))],2),e("span",{staticClass:"to-text"},[t._v("-")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.endDate,expression:"endDate"}],on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.endDate=e.target.multiple?a:a[0]}}},[e("option",{attrs:{value:""}},[t._v("ç»“æŸæ—¶é—´")]),t._l(t.options.month_time,(function(a){return e("option",{key:a,domProps:{value:a}},[t._v(t._s(a))])}))],2)]),e("div",{staticClass:"filter-item"},[e("label",[t._v("çœçº§è¡Œæ”¿åŒºï¼š")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.province,expression:"province"}],on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.province=e.target.multiple?a:a[0]}}},[e("option",{attrs:{value:""}},[t._v("å…¨éƒ¨")]),t._l(t.options.province_area,(function(a){return e("option",{key:a,domProps:{value:a}},[t._v(t._s(a))])}))],2)])]),e("div",{staticClass:"filter-row"},[e("div",{staticClass:"filter-item"},[e("label",[t._v("å…¥è¡¨ä¼ä¸šï¼š")]),e("el-select",{attrs:{filterable:"",remote:"",clearable:"",placeholder:"è¯·è¾“å…¥å…³é”®è¯","remote-method":t.fetchCompanyOptions,loading:t.loading.company},on:{clear:t.onCompanyCleared},model:{value:t.company,callback:function(e){t.company=e},expression:"company"}},t._l(t.companyOptions,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("div",{staticClass:"filter-item"},[e("label",[t._v("æ•°æ®èµ„äº§å†…å®¹ï¼š")]),e("el-select",{attrs:{filterable:"",remote:"",clearable:"",placeholder:"è¯·è¾“å…¥å…³é”®è¯","remote-method":t.fetchContentOptions,loading:t.loading.content},on:{clear:t.onContentCleared},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}},t._l(t.contentOptions,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]),e("div",{staticClass:"filter-row row-actions"},[e("div",{staticClass:"action-buttons"},[e("button",{staticClass:"confirm-btn",on:{click:t.confirmFilters}},[t._v("ç¡®è®¤")]),e("button",{staticClass:"clear-all-btn",on:{click:t.clearFilters}},[t._v("æ¸…é™¤ç­›é€‰")])])])])},Q=[],B={name:"FilterSection",props:{apiPrefix:{type:String,required:!0},options:{type:Object,required:!0},filters:{type:Object,required:!0}},data(){return{startDate:"",endDate:"",province:"",company:"",content:"",companyOptions:[],contentOptions:[],loading:{company:!1,content:!1}}},watch:{filters:{immediate:!0,deep:!0,handler(t){this.startDate=t.startDate||"",this.endDate=t.endDate||"",this.province=t.province||"",this.company=t.company||"",this.content=t.content||""}}},methods:{fetchCompanyOptions(t){t&&(this.loading.company=!0,m.A.get(`${this.apiPrefix}/search/company?q=${t}`).then((t=>{this.companyOptions=(t.data||[]).map((t=>({label:t,value:t})))})).finally((()=>{this.loading.company=!1})))},fetchContentOptions(t){t&&(this.loading.content=!0,m.A.get(`${this.apiPrefix}/search/content?q=${t}`).then((t=>{this.contentOptions=(t.data||[]).map((t=>({label:t,value:t})))})).finally((()=>{this.loading.content=!1})))},confirmFilters(){this.$emit("filter-change",{startDate:this.startDate,endDate:this.endDate,province:this.province,company:this.company,content:this.content})},clearFilters(){this.startDate="",this.endDate="",this.province="",this.company="",this.content="",this.confirmFilters()},onCompanyCleared(){this.company="",this.confirmFilters()},onContentCleared(){this.content="",this.confirmFilters()}}},K=B,z=(0,l.A)(K,E,Q,!1,null,"12772658",null),G=z.exports,V=function(){var t=this,e=t._self._c;return e("div",{staticClass:"chart-grid"},[e("div",{staticClass:"chart-row"},[t.charts.province_area?.length?e("div",{staticClass:"chart-full"},[e("BarChart1",{attrs:{"chart-data":t.charts.province_area}})],1):t._e()]),e("div",{staticClass:"chart-row"},[t.charts.company_type?.length?e("div",{staticClass:"pie-1"},[e("PieChart1",{attrs:{"chart-data":t.charts.company_type,filters:t.filters,mode:t.mode}})],1):t._e()]),t.charts[t.barChart2Field]?.length?e("div",{staticClass:"chart-row"},[e("div",{staticClass:"chart-full"},[e("BarChart2",{attrs:{"chart-data":t.charts[t.barChart2Field]}})],1)]):t._e(),e("div",{staticClass:"fixed-pie-row"},[t.charts.dataasset_type?.length?e("div",{staticClass:"pie-30"},[e("PieChart2",{attrs:{"chart-data":t.charts.dataasset_type}})],1):t._e(),t.charts.dataasset_register_addrtype?.length?e("div",{staticClass:"pie-70"},[e("PieChart3",{attrs:{"chart-data":t.charts.dataasset_register_addrtype}})],1):t._e()])])},I=[],H=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"chart-wrapper",staticStyle:{position:"relative"}},[e("div",{staticClass:"chart-title"},[t._v("ä¼ä¸šæ•°é‡æŒ‰çœä»½åˆ†å¸ƒ")]),e("ChartSpinner",{attrs:{visible:t.loading}}),e("v-chart",{staticStyle:{width:"100%",height:"360px"},attrs:{option:t.barChartOption}})],1)},U=[],W=a(6589);const Y=["#003049","#005f73","#0a9396","#94d2bd","#e9d8a6","#ee9b00","#ca6702","#bb3e03","#780000","#c1121f","#fdf0d5","#669bbc"];var X=Y,J=a(3087),Z=a(6411),tt=a(6756),et=a(4064),at=a(3416),st=a(5620),it=a(5690);(0,J.Y)([Z.a,tt.a,et.a,at.a,st.a,it.a]);var rt=(0,s.defineComponent)({name:"BarChart1",components:{VChart:W.Ay,ChartSpinner:O},props:{chartData:{type:Array,default:()=>[]}},data(){return{barChartOption:{},loading:!1}},watch:{chartData:{handler(){this.updateChart()},immediate:!0}},methods:{updateChart(){this.loading=!0,setTimeout((()=>{this.barChartOption={color:X,tooltip:{},xAxis:{type:"category",data:this.chartData.map((t=>t.name)),axisLabel:{rotate:0,formatter:t=>t.length>6?t.slice(0,6)+"â€¦":t}},yAxis:{type:"value",name:"å…¥è¡¨ä¼ä¸šæ•°é‡ï¼ˆå®¶ï¼‰",nameLocation:"middle",nameGap:40,nameTextStyle:{fontSize:12}},series:[{type:"bar",data:this.chartData.map((t=>t.value))}]},this.loading=!1}),500)}}}),nt=rt,ot=(0,l.A)(nt,H,U,!1,null,"8ad16e84",null),lt=ot.exports,ct=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"chart-wrapper",staticStyle:{position:"relative"}},[e("div",{staticClass:"chart-title"},[t._v("ä¼ä¸šæ•°é‡æŒ‰ä¼ä¸šæ€§è´¨åˆ†å¸ƒ")]),e("ChartSpinner",{attrs:{visible:t.loading}}),e("v-chart",{staticStyle:{width:"100%",height:"360px"},attrs:{option:t.chartOption}})],1)},dt=[],ut=a(9166),ht=a(381);(0,J.Y)([Z.a,ut.a,et.a,at.a,it.a,ht.a]);var pt=(0,s.defineComponent)({name:"PieChart1",components:{VChart:W.Ay,ChartSpinner:O},props:{chartData:{type:Array,required:!0},filters:{type:Object,required:!0},mode:{type:String,default:"nls"}},setup(t){const e=(0,s.ref)({}),a=(0,s.ref)(!1),i=async()=>{a.value=!0;const s=t.chartData||[],i="åœ°æ–¹å›½ä¼",r="ls"===t.mode?"/api/lasset/summary":"/api/nlasset/summary";try{const a=await m.A.post(r,{filters:{...t.filters,company_type:i},page:1,pageSize:1}),n=a.data.charts?.admin_level||[];e.value={color:X,tooltip:{trigger:"item"},legend:{show:!1},series:[{name:"ä¼ä¸šç±»å‹",type:"pie",radius:"50%",center:["35%","35%"],label:{show:!0,formatter:({name:t,value:e})=>`${t}: ${e}`,position:"outside"},startAngle:145,labelLine:{show:!0},data:s},{name:"è¡Œæ”¿çº§åˆ«",type:"pie",radius:"40%",center:["65%","35%"],label:{show:!0,formatter:({name:t,value:e})=>`${t}: ${e}`,position:"inside"},labelLine:{show:!0},data:n}],graphic:[{type:"line",shape:{x1:495,y1:36,x2:920,y2:55},style:{stroke:"#888",lineWidth:1}},{type:"line",shape:{x1:495,y1:216,x2:920,y2:197},style:{stroke:"#888",lineWidth:1}}]}}catch(n){console.error("âŒ åŠ è½½ PieChart1 æ•°æ®å¤±è´¥:",n)}finally{a.value=!1}};return(0,s.onMounted)(i),(0,s.watch)((()=>t.chartData),i,{deep:!0}),(0,s.watch)((()=>t.filters),i,{deep:!0}),{chartOption:e,loading:a}}}),mt=pt,ft=(0,l.A)(mt,ct,dt,!1,null,"4018c487",null),gt=ft.exports,vt=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"chart-wrapper",staticStyle:{position:"relative"}},[e("div",{staticClass:"chart-title"},[t._v("ä¼ä¸šæ•°é‡æŒ‰ä¼ä¸šä¸šåŠ¡ç±»å‹åˆ†å¸ƒ")]),e("ChartSpinner",{attrs:{visible:t.loading}}),e("v-chart",{staticStyle:{width:"100%",height:"450px"},attrs:{option:t.chartOption}})],1)},bt=[],_t=(0,s.defineComponent)({name:"BarChart2",components:{"v-chart":W.Ay,ChartSpinner:O},props:{chartData:{type:Array,default:()=>[]}},setup(t){const e=(0,s.ref)({}),a=(0,s.ref)(!1),i=()=>{a.value=!0,setTimeout((()=>{e.value={color:X,tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},xAxis:{type:"category",data:t.chartData.map((t=>t.name)),axisLabel:{fontSize:12,rotate:0,rich:{customStyle:{lineHeight:20}},formatter:t=>{const e=t.match(/.{1,5}/g)?.slice(0,4)||[t];return e.map((t=>`{customStyle|${t}}`)).join("\n")}}},yAxis:{type:"value",name:"ä¼ä¸šä¸šåŠ¡ç±»å‹",nameLocation:"middle",nameGap:60,nameTextStyle:{fontSize:14}},series:[{type:"bar",data:t.chartData.map((t=>t.value))}]},a.value=!1}),500)};return(0,s.watch)((()=>t.chartData),i,{immediate:!0,deep:!0}),{chartOption:e,loading:a}}}),yt=_t,Ct=(0,l.A)(yt,vt,bt,!1,null,"3a085451",null),wt=Ct.exports,St=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"chart-wrapper",staticStyle:{position:"relative"}},[e("div",{staticClass:"chart-title"},[t._v("ä¼ä¸šæ•°é‡æŒ‰æ•°æ®èµ„äº§ç±»å‹åˆ†å¸ƒ")]),e("ChartSpinner",{attrs:{visible:t.loading}}),e("v-chart",{staticStyle:{width:"100%",height:"60%"},attrs:{option:t.chartOption}})],1)},xt=[],Tt=(0,s.defineComponent)({name:"PieChart2",components:{"v-chart":W.Ay,ChartSpinner:O},props:{chartData:{type:Array,default:()=>[]}},setup(t){const e=(0,s.ref)({}),a=(0,s.ref)(!1),i=()=>{a.value=!0,setTimeout((()=>{e.value={color:X,tooltip:{trigger:"item"},legend:{show:!1},series:[{type:"pie",radius:"50%",data:t.chartData,label:{show:!0,formatter:({name:t,value:e})=>`${t}: ${e}`,position:"outside"},labelLine:{show:!0},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},a.value=!1}),500)};return(0,s.watch)((()=>t.chartData),i,{immediate:!0,deep:!0}),{chartOption:e,loading:a}}}),Pt=Tt,Dt=(0,l.A)(Pt,St,xt,!1,null,"74dfb300",null),kt=Dt.exports,Lt=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"chart-wrapper",staticStyle:{position:"relative"}},[e("div",{staticClass:"chart-title"},[t._v("ä¼ä¸šæ•°é‡æŒ‰èµ„äº§ç™»è®°æœºæ„åˆ†å¸ƒ")]),e("ChartSpinner",{attrs:{visible:t.loading}}),e("v-chart",{staticStyle:{width:"100%",height:"60%"},attrs:{option:t.chartOption}})],1)},At=[],Ft=(0,s.defineComponent)({name:"PieChart3",components:{"v-chart":W.Ay,ChartSpinner:O},props:{chartData:{type:Array,default:()=>[]}},setup(t){const e=(0,s.ref)({}),a=(0,s.ref)(!1),i=()=>{a.value=!0,setTimeout((()=>{e.value={color:X,tooltip:{trigger:"item"},legend:{show:!1},series:[{type:"pie",radius:"50%",data:t.chartData,label:{show:!0,formatter:({name:t,value:e})=>`${t}: ${e}`,position:"outside"},labelLine:{show:!0},emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]},a.value=!1}),500)};return(0,s.watch)((()=>t.chartData),i,{immediate:!0,deep:!0}),{chartOption:e,loading:a}}}),Ot=Ft,jt=(0,l.A)(Ot,Lt,At,!1,null,"1d475cd7",null),$t=jt.exports,qt={name:"ChartRow",components:{BarChart1:lt,PieChart1:gt,BarChart2:wt,PieChart2:kt,PieChart3:$t},props:{charts:{type:Object,required:!0},filters:{type:Object,required:!0},mode:{type:String,required:!0,validator:t=>["nls","ls"].includes(t)}},computed:{barChart2Field(){return"ls"===this.mode?"business_type":"company_business_type"}}},Nt=qt,Rt=(0,l.A)(Nt,V,I,!1,null,"8c8226c4",null),Mt=Rt.exports,Et=function(){var t=this,e=t._self._c;return e("div",{staticClass:"table-section",staticStyle:{position:"relative"}},[e("h3",{staticClass:"section-title"},[t._v("æœç´¢ç»“æœæ•°æ®è¯¦æƒ…")]),e("ChartSpinner",{attrs:{visible:t.loading}}),e("div",{staticClass:"table-wrapper"},[e("table",{staticClass:"data-table"},[t._m(0),e("tbody",t._l(t.tableData,(function(a,s){return e("tr",{key:s},[e("td",{staticStyle:{"text-align":"center"}},[t._v(t._s((t.currentPage-1)*t.pageSize+s+1))]),e("td",[t._v(t._s(a.month_time))]),e("td",[t._v(t._s(a.province_area))]),e("td",[t._v(t._s(a.company_name))]),e("td",[t._v(t._s(a.dataasset_content))]),e("td",[t._v(t._s(a.accounting_subject))]),e("td",[t._v(t._s(a.valuation_method))]),e("td",{staticClass:"number-cell"},[t._v(t._s(t.formatNumber(a.book_value)))]),e("td",{staticClass:"number-cell"},[t._v(t._s(t.formatNumber(a.assess_value)))]),e("td",[t._v(t._s(a.dataasset_register_addr))])])})),0)])]),e("div",{staticClass:"pagination"},[e("div",{staticClass:"pagination-left"},[e("el-dropdown",{on:{command:t.handleExportCommand}},[e("el-button",{staticClass:"export-small-btn",attrs:{type:"primary"}},[t._v(" ä¸‹è½½ Excel"),e("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{command:"all"}},[t._v("ä¸‹è½½å…¨éƒ¨æ•°æ®")]),e("el-dropdown-item",{attrs:{command:"current"}},[t._v("ä¸‹è½½å½“å‰æ•°æ®")])],1)],1)],1),e("div",{staticClass:"pagination-center"},[e("button",{attrs:{disabled:1===t.currentPage},on:{click:function(e){return t.changePage(t.currentPage-1)}}},[t._v("ä¸Šä¸€é¡µ")]),e("span",{staticClass:"page-info"},[t._v(t._s(t.currentPage)+" / "+t._s(t.totalPages))]),e("button",{attrs:{disabled:t.currentPage>=t.totalPages},on:{click:function(e){return t.changePage(t.currentPage+1)}}},[t._v("ä¸‹ä¸€é¡µ")])]),e("div",{staticClass:"pagination-right"})])],1)},Qt=[function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("th",{staticStyle:{"text-align":"center"}},[t._v("åºå·")]),e("th",{staticStyle:{"text-align":"center"}},[t._v("å…¥è¡¨æœˆä»½")]),e("th",[t._v("çœçº§è¡Œæ”¿åŒº")]),e("th",[t._v("å…¥è¡¨ä¼ä¸š")]),e("th",[t._v("æ•°æ®èµ„äº§å†…å®¹")]),e("th",{staticStyle:{"text-align":"center"}},[t._v("å…¥è¡¨ä¼šè®¡ç§‘ç›®")]),e("th",{staticStyle:{"text-align":"center"}},[t._v("è¯„ä¼°æ–¹æ³•")]),e("th",[t._v("è´¦é¢é‡‘é¢"),e("br"),t._v("ï¼ˆä¸‡å…ƒï¼‰")]),e("th",[t._v("è¯„ä¼°é‡‘é¢"),e("br"),t._v("ï¼ˆä¸‡å…ƒï¼‰")]),e("th",[t._v("æ•°æ®èµ„äº§ç™»è®°æœºæ„")])])])}],Bt=(a(7588),{name:"DataTable",components:{ChartSpinner:O},props:{filters:{type:Object,required:!0},tableData:{type:Array,required:!0},totalRows:{type:Number,required:!0},pageSize:{type:Number,default:10},apiPrefix:{type:String,required:!0}},data(){return{currentPage:1,initialized:!1,loading:!1}},computed:{totalPages(){return Math.max(1,Math.ceil(this.totalRows/this.pageSize))}},watch:{filters:{handler(){this.initialized?(this.loading=!0,this.currentPage=1,this.emitPageChange()):this.initialized=!0},immediate:!0,deep:!0}},methods:{changePage(t){t<1||t>this.totalPages||(this.loading=!0,this.currentPage=t,this.emitPageChange())},emitPageChange(){this.$emit("page-change",this.currentPage)},stopLoading(){this.loading=!1,this.$emit("data-loaded")},formatNumber(t){if(null===t||void 0===t||""===t)return"-";const e=parseFloat(t);return isNaN(e)?t:e.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})},handleExportCommand(t){"all"===t?this.downloadFull():"current"===t&&this.downloadCurrent()},async exportToExcel(t,e,s){try{this.loading=!0;const i=await m.A.post(t,{filters:e},{responseType:"json"}),r=i.data?.rows||[];if(!r.length)return;const n=Object.keys(r[0]),o=await a.e(974).then(a.t.bind(a,4974,23)),l=new o.Workbook,c=l.addWorksheet("å¯¼å‡ºæ•°æ®");c.columns=n.map((t=>({header:t,key:t,width:20}))),r.forEach((t=>c.addRow(t)));const d=await l.xlsx.writeBuffer(),u=new Blob([d],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});this.saveBlob(u,s)}catch(i){console.error("âŒ å¯¼å‡ºå¤±è´¥:",i)}finally{this.loading=!1}},async downloadFull(){const t=`export_full_${Date.now()}.xlsx`;await this.exportToExcel(`${this.apiPrefix}/export`,{},t)},async downloadCurrent(){const t=`export_filter_${Date.now()}.xlsx`;await this.exportToExcel(`${this.apiPrefix}/export`,this.filters,t)},saveBlob(t,e){const a=window.URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.setAttribute("download",e),document.body.appendChild(s),s.click(),document.body.removeChild(s)}}}),Kt=Bt,zt=(0,l.A)(Kt,Et,Qt,!1,null,"c0dfa6d0",null),Gt=zt.exports,Vt={name:"NLSDashboardPage",components:{FilterSection:G,ChartRow:Mt,DataTable:Gt,LoadingSpinner:P},data(){return{isLoading:!0,filters:{},pendingFilters:{},pageSize:10,currentPageData:[],totalRows:0,charts:{},options:{}}},methods:{async handleFilterChange(t){this.filters={...t},await this.fetchSummaryData(1)},async handlePageChange(t){await this.fetchSummaryData(t)},async fetchSummaryData(t){!1===this.isLoading&&this.$refs.dataTable?.startLoading?.();try{const e=await m.A.post("/api/nlasset/summary",{filters:this.filters,page:t,pageSize:this.pageSize});this.charts=e.data.charts||{},this.currentPageData=e.data.table.rows||[],this.totalRows=e.data.table.total||0,this.options=e.data.options||{},this.pendingFilters={...this.filters}}catch(e){console.error("âŒ åŠ è½½ summary æ•°æ®å¤±è´¥:",e)}finally{this.isLoading=!1,this.$refs.dataTable?.stopLoading?.()}}},mounted(){this.fetchSummaryData(1)}},It=Vt,Ht=(0,l.A)(It,R,M,!1,null,"42f2bf27",null),Ut=Ht.exports,Wt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"dashboard-page"},[e("LoadingSpinner",{attrs:{visible:t.isLoading}}),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],staticClass:"dashboard-title-block"},[e("h1",{staticClass:"dashboard-title"},[t._v("ä¸Šå¸‚å…¬å¸æ•°æ®èµ„äº§æƒ…å†µ")]),e("p",{staticClass:"dashboard-subtitle"},[t._v("Overview of Listed Company Data Assets")])]),e("LFilterSection",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],attrs:{filters:t.filters,mode:"ls"},on:{"update:filters":t.onFilterUpdate}}),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.isLoading,expression:"!isLoading"}],staticClass:"dashboard-container"},[e("LChartRow",{attrs:{filters:t.filters}})],1)],1)},Yt=[],Xt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"filter-section"},[e("div",{staticClass:"filter-row"},[e("div",{staticClass:"filter-item"},[e("label",[t._v("æŠ¥å‘Šæ—¶é—´ï¼š")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.quarter,expression:"quarter"}],on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.quarter=e.target.multiple?a:a[0]}}},[e("option",{attrs:{value:""}},[t._v("å…¨éƒ¨")]),t._l(t.options.quarter,(function(a){return e("option",{key:a,domProps:{value:a}},[t._v(t._s(a))])}))],2)]),e("div",{staticClass:"filter-item"},[e("label",[t._v("çœä»½ï¼š")]),e("select",{directives:[{name:"model",rawName:"v-model",value:t.province_area,expression:"province_area"}],on:{change:function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.province_area=e.target.multiple?a:a[0]}}},[e("option",{attrs:{value:""}},[t._v("å…¨éƒ¨")]),t._l(t.options.province_area,(function(a){return e("option",{key:a,domProps:{value:a}},[t._v(t._s(a))])}))],2)])]),e("div",{staticClass:"filter-row"},[e("div",{staticClass:"filter-item"},[e("label",[t._v("å…¬å¸ï¼š")]),e("el-select",{attrs:{filterable:"",remote:"",clearable:"",placeholder:"è¯·è¾“å…¥å…¬å¸å…³é”®è¯","remote-method":t.fetchCompanyOptions,loading:t.loading.company},on:{clear:t.onCompanyCleared},model:{value:t.company,callback:function(e){t.company=e},expression:"company"}},t._l(t.companyOptions,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("div",{staticClass:"filter-item"},[e("label",[t._v("æ‰€å±è¯åˆ¸è¡Œä¸šåˆ†å¸ƒï¼š")]),e("el-select",{attrs:{filterable:"",remote:"",clearable:"",placeholder:"è¯·è¾“å…¥è¡Œä¸šå…³é”®è¯","remote-method":t.fetchContentOptions,loading:t.loading.content},on:{clear:t.onContentCleared},model:{value:t.dataasset_content,callback:function(e){t.dataasset_content=e},expression:"dataasset_content"}},t._l(t.contentOptions,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1)]),e("div",{staticClass:"filter-row row-actions"},[e("div",{staticClass:"action-buttons"},[e("button",{staticClass:"confirm-btn",on:{click:t.confirmFilters}},[t._v("ç¡®è®¤")]),e("button",{staticClass:"clear-all-btn",on:{click:t.clearFilters}},[t._v("æ¸…é™¤ç­›é€‰")])])])])},Jt=[],Zt={name:"LFilterSection",props:{filters:{type:Object,required:!0},options:{type:Object,required:!0}},data(){return{quarter:"",province_area:"",company:"",dataasset_content:"",companyOptions:[],contentOptions:[],loading:{company:!1,content:!1}}},watch:{filters:{immediate:!0,deep:!0,handler(t){this.quarter=t.quarter||"",this.province_area=t.province_area||"",this.company=t.company||"",this.dataasset_content=t.dataasset_content||""}}},methods:{fetchCompanyOptions(t){t&&(this.loading.company=!0,m.A.get("/api/lasset/search/company?q="+t).then((t=>{this.companyOptions=t.data.map((t=>({label:t,value:t})))})).finally((()=>{this.loading.company=!1})))},fetchContentOptions(t){t&&(this.loading.content=!0,m.A.get("/api/lasset/search/content?q="+t).then((t=>{this.contentOptions=t.data.map((t=>({label:t,value:t})))})).finally((()=>{this.loading.content=!1})))},confirmFilters(){this.$emit("update:filters",{quarter:this.quarter,province_area:this.province_area,company:this.company,dataasset_content:this.dataasset_content})},clearFilters(){this.quarter="",this.province_area="",this.company="",this.dataasset_content="",this.confirmFilters()},onCompanyCleared(){this.company="",this.confirmFilters()},onContentCleared(){this.dataasset_content="",this.confirmFilters()}}},te=Zt,ee=(0,l.A)(te,Xt,Jt,!1,null,"4ac13d85",null),ae=ee.exports,se=function(){var t=this,e=t._self._c;return e("div",{staticClass:"chart-grid"},[e("div",{staticClass:"chart-row"},[t.comboData.barSeries?.length&&t.comboData.lineSeries?.length?e("div",{staticClass:"chart-full"},[e("ComboBarLineChart",{attrs:{chartTitle:"å…¥è¡¨è¶‹åŠ¿å›¾ï¼ˆæ•°é‡ + é‡‘é¢ï¼‰",categories:t.comboData.categories,barSeries:t.comboData.barSeries,lineSeries:t.comboData.lineSeries}})],1):t._e()]),e("div",{staticClass:"chart-row"},[t.comboData.tableRows?.length?e("div",{staticClass:"chart-full"},[e("ComboTable",{attrs:{"table-rows":t.comboData.tableRows}})],1):t._e()]),e("div",{staticClass:"chart-row"},[t.groupedSubjectData.countSeries?.length?e("div",{staticClass:"chart-half"},[e("GroupedBarChart",{attrs:{"chart-data":t.groupedSubjectData.countSeries,title:"æŒ‰å…¥è¡¨ç§‘ç›®ç»Ÿè®¡æ•°é‡","row-key":"å…¥è¡¨ç§‘ç›®","col-key":"æŠ¥å‘Šæ—¶é—´"}})],1):t._e(),t.groupedSubjectData.sumSeries?.length?e("div",{staticClass:"chart-half"},[e("GroupedBarChart",{attrs:{"chart-data":t.groupedSubjectData.sumSeries,title:"æŒ‰å…¥è¡¨ç§‘ç›®ç»Ÿè®¡é‡‘é¢","row-key":"å…¥è¡¨ç§‘ç›®","col-key":"æŠ¥å‘Šæ—¶é—´"}})],1):t._e()]),e("div",{staticClass:"chart-row"},t._l(t.filteredSubjectNames,(function(a,s){return e("div",{key:s,staticClass:"chart-full"},[e("SubjectTable",{attrs:{title:a,"count-data":t.subjectTables[a]?.count,"sum-data":t.subjectTables[a]?.total}})],1)})),0),t._l(t.groupedFields,(function(a){return e("div",{key:a.field,staticClass:"chart-row"},[t.groupedCharts[a.field]?.length?e("div",{staticClass:"chart-full"},[e("GroupedBarChart",{attrs:{"chart-data":t.groupedCharts[a.field],title:a.title,"row-key":"name","col-key":"æŠ¥å‘Šæ—¶é—´"}})],1):t._e(),t.groupedCharts[a.field]?.length?e("div",{staticClass:"chart-full"},[e("TransposedTable",{attrs:{data:t.groupedCharts[a.field],"row-key":"name","col-key":"æŠ¥å‘Šæ—¶é—´","val-key":"value"}})],1):t._e()])})),e("div",{staticClass:"chart-row"},[t.controlData.original?.length?e("div",{staticClass:"chart-half"},[e("TransposedTable",{attrs:{data:t.controlData.original,"row-key":"å®æ§äºº","col-key":"æŠ¥å‘Šæ—¶é—´","val-key":"value",title:"å®æ§äººåŸå§‹åˆ†å¸ƒ"}})],1):t._e(),t.controlData.classified?.length?e("div",{staticClass:"chart-half"},[e("TransposedTable",{attrs:{data:t.flattenClassified(t.controlData.classified),"row-key":"name","col-key":"æŠ¥å‘Šæ—¶é—´","val-key":"value",title:"å®æ§äººåˆ†ç±»æ±‡æ€»"}})],1):t._e()])],2)},ie=[],re=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"chart-wrapper",staticStyle:{position:"relative"}},[e("div",{staticClass:"chart-title"},[t._v(t._s(t.chartTitle))]),e("ChartSpinner",{attrs:{visible:t.loading}}),!t.loading&&t.chartOption.series&&t.chartOption.series.length?e("v-chart",{staticStyle:{width:"100%",height:"440px"},attrs:{option:t.chartOption}}):t._e()],1)},ne=[],oe=(0,s.defineComponent)({name:"ComboBarLineChart",components:{VChart:W.Ay,ChartSpinner:O},props:{chartTitle:{type:String,default:"æŸ±çŠ¶å›¾ + æŠ˜çº¿å›¾"},categories:{type:Array,default:()=>[]},barSeries:{type:Array,default:()=>[]},lineSeries:{type:Object,default:()=>({name:"æŠ˜çº¿",data:[]})},yAxisBarName:{type:String,default:"æ•°é‡ï¼ˆä¸ªï¼‰"},yAxisLineName:{type:String,default:"æ¯”ä¾‹ï¼ˆ%ï¼‰"}},setup(t){const e=(0,s.ref)({}),a=(0,s.ref)(!1),i=()=>{a.value=!0,setTimeout((()=>{const s=(t.barSeries||[]).map(((t,e)=>({name:t.name,type:"bar",data:t.data||[],yAxisIndex:0,itemStyle:{color:X[e%X.length]}}))),i={name:t.lineSeries?.name||"æŠ˜çº¿",type:"line",data:t.lineSeries?.data||[],yAxisIndex:1,symbol:"circle",lineStyle:{width:3},itemStyle:{color:X[t.barSeries.length%X.length]}};e.value={color:X,tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{top:10},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:t.categories||[],axisLabel:{fontSize:12,rotate:0,formatter:t=>t.length>6?t.slice(0,6)+"â€¦":t}},yAxis:[{type:"value",name:t.yAxisBarName,nameLocation:"middle",nameGap:45,nameTextStyle:{fontSize:14}},{type:"value",name:t.yAxisLineName,nameLocation:"middle",nameGap:45,nameTextStyle:{fontSize:14}}],series:[...s,i]},a.value=!1}),500)};return(0,s.watch)((()=>[t.barSeries,t.lineSeries,t.categories]),i,{immediate:!0,deep:!0}),{chartOption:e,loading:a}}}),le=oe,ce=(0,l.A)(le,re,ne,!1,null,"057bb294",null),de=ce.exports,ue=function(){var t=this,e=t._self._c;return e("div",{staticClass:"table-section"},[e("h3",{staticClass:"section-title"},[t._v("å…¥è¡¨è¶‹åŠ¿æ•°æ®è¯¦æƒ…")]),e("div",{staticClass:"table-wrapper"},[e("table",{staticClass:"data-table"},[t._m(0),e("tbody",t._l(t.tableRows,(function(a){return e("tr",{key:a.æŠ¥å‘Šæ—¶é—´},[e("td",[t._v(t._s(a["æŠ¥å‘Šæ—¶é—´"]))]),e("td",{staticStyle:{"text-align":"right"}},[t._v(t._s(a["å…¥è¡¨æ•°é‡"]))]),e("td",{staticStyle:{"text-align":"right"}},[t._v(t._s(t.format(a["å…¥è¡¨æ€»é¢ï¼ˆä¸‡å…ƒï¼‰"])))])])})),0)])])])},he=[function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("th",[t._v("æŠ¥å‘Šæ—¶é—´")]),e("th",[t._v("æ•°æ®èµ„æºå…¥è¡¨æ•°é‡")]),e("th",[t._v("æ•°æ®èµ„æºå…¥è¡¨æ€»é¢ï¼ˆå•ä½ï¼šä¸‡å…ƒï¼‰")])])])}],pe={name:"ComboTable",props:{tableRows:Array},methods:{format(t){const e=parseFloat(t);return isNaN(e)?"â€”":e.toLocaleString(void 0,{minimumFractionDigits:2})}}},me=pe,fe=(0,l.A)(me,ue,he,!1,null,"688931a0",null),ge=fe.exports,ve=function(){var t=this,e=t._self._c;t._self._setupProxy;return e("div",{staticClass:"chart-wrapper",staticStyle:{position:"relative"}},[e("div",{staticClass:"chart-title"},[t._v(t._s(t.chartTitle))]),e("ChartSpinner",{attrs:{visible:t.loading}}),e("v-chart",{staticStyle:{width:"100%",height:"440px"},attrs:{option:t.chartOption}})],1)},be=[],_e=(a(7642),a(8004),a(3853),a(5876),a(2475),a(5024),a(1698),(0,s.defineComponent)({name:"GroupedBarChart",components:{VChart:W.Ay,ChartSpinner:O},props:{chartTitle:{type:String,default:"Grouped Bar Chart"},chartData:{type:Array,default:()=>[]},rowKey:{type:String,default:"ç±»åˆ«"},valKey:{type:String,default:"value"}},setup(t){const e=(0,s.ref)({}),a=(0,s.ref)(!1),i=()=>{a.value=!0,setTimeout((()=>{const s=t.chartData||[],i=new Set;s.forEach((e=>{(e.data||[]).forEach((e=>{i.add(e[t.rowKey])}))}));const r=Array.from(i),n=s.map(((e,a)=>{const s=Object.fromEntries((e.data||[]).map((e=>[e[t.rowKey],e[t.valKey]]))),i=r.map((t=>s[t]||0));return{name:e.name,type:"bar",data:i,barGap:0,barCategoryGap:"50%",itemStyle:{color:X[a%X.length]}}}));e.value={color:X,tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{top:10},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",data:r,axisLabel:{fontSize:12,rotate:0,formatter:t=>t.length>6?t.slice(0,6)+"â€¦":t}},yAxis:{type:"value",name:"æ•°é‡ï¼ˆä¸ªï¼‰",nameLocation:"middle",nameGap:50,nameTextStyle:{fontSize:14}},series:n},a.value=!1}),300)};return(0,s.watch)((()=>t.chartData),i,{immediate:!0,deep:!0}),{chartOption:e,loading:a}}})),ye=_e,Ce=(0,l.A)(ye,ve,be,!1,null,"2ec46322",null),we=Ce.exports,Se=function(){var t=this,e=t._self._c;return e("div",{staticClass:"table-section"},[e("h3",{staticClass:"section-title"},[t._v(t._s(t.title)+" æ•°æ®èµ„æºå…¥è¡¨è¯¦æƒ…")]),e("div",{staticClass:"table-wrapper"},[e("table",{staticClass:"data-table"},[e("thead",[e("tr",[e("th",[t._v("æŠ¥å‘Šæ—¶é—´")]),e("th",[t._v(t._s(t.title)+"-æ•°æ®èµ„æºå…¥è¡¨æ•°é‡")]),e("th",[t._v(t._s(t.title)+"-æ•°æ®èµ„æºå…¥è¡¨æ€»é¢ï¼ˆä¸‡å…ƒï¼‰")])])]),e("tbody",t._l(t.formattedRows,(function(a){return e("tr",{key:a.reportTime},[e("td",[t._v(t._s(a.reportTime))]),e("td",{staticStyle:{"text-align":"right"}},[t._v(t._s(t.formatValue(a.count)))]),e("td",{staticStyle:{"text-align":"right"}},[t._v(t._s(t.formatNumber(a.total)))])])})),0)])])])},xe=[],Te=(a(8237),{name:"SubjectTable",props:{title:String,countData:Array,sumData:Array},computed:{formattedRows(){const t={},e=`${this.title}-æ•°æ®èµ„æºå…¥è¡¨æ•°é‡`,a=`${this.title}-æ•°æ®èµ„æºå…¥è¡¨æ€»é¢ï¼ˆä¸‡å…ƒï¼‰`;this.countData.forEach((a=>{const s=a["æŠ¥å‘Šæ—¶é—´"];s&&"åˆè®¡"!==s&&(t[s]||(t[s]={reportTime:s,count:0,total:0}),t[s].count=parseInt(a[e],10)||0)})),this.sumData.forEach((e=>{const s=e["æŠ¥å‘Šæ—¶é—´"];s&&"åˆè®¡"!==s&&(t[s]||(t[s]={reportTime:s,count:0,total:0}),t[s].total=parseFloat(e[a])||0)}));const s=Object.values(t).sort(((t,e)=>t.reportTime.localeCompare(e.reportTime))),i={reportTime:"åˆè®¡",count:s.reduce(((t,e)=>t+(parseInt(e.count)||0)),0),total:s.reduce(((t,e)=>t+(parseFloat(e.total)||0)),0)};return[...s,i]}},methods:{formatNumber(t){const e=parseFloat(t);return isNaN(e)?"â€”":e.toLocaleString(void 0,{minimumFractionDigits:2})},formatValue(t){return null===t||void 0===t||isNaN(t)?"â€”":t}}}),Pe=Te,De=(0,l.A)(Pe,Se,xe,!1,null,"062dc124",null),ke=De.exports,Le=function(){var t=this,e=t._self._c;return e("div",{staticClass:"table-section"},[t.title?e("h3",{staticClass:"section-title"},[t._v(t._s(t.title))]):t._e(),e("div",{staticClass:"table-wrapper"},[e("table",{staticClass:"data-table"},[e("thead",[e("tr",[e("th",[t._v(t._s(t.rowLabel))]),t.hasDefinition?e("th",[t._v("å«ä¹‰")]):t._e(),t._l(t.columns,(function(a){return e("th",{key:a},[t._v(t._s(a))])}))],2)]),e("tbody",t._l(t.rowDataWithTotal,(function(a,s){return e("tr",{key:s},[e("td",[t._v(t._s(a.label))]),t.hasDefinition?e("td",[t._v(t._s(a.definition||"-"))]):t._e(),t._l(t.columns,(function(s){return e("td",{key:s,staticStyle:{"text-align":"right"}},[t._v(" "+t._s(t.formatNumber(a[s]))+" ")])}))],2)})),0)])])])},Ae=[],Fe=(a(3579),{name:"TransposedTable",props:{data:{type:Array,default:()=>[]},rowKey:{type:String,required:!0},colKey:{type:String,required:!0},valKey:{type:String,required:!0},title:{type:String,default:""},rowLabel:{type:String,default:"åç§°"},transpose:{type:Boolean,default:!0}},computed:{hasDefinition(){return this.data.some((t=>t.definition))},columns(){const t=new Set(this.data.map((t=>t[this.colKey])));return Array.from(t).sort()},rowData(){const t={};return this.data.forEach((e=>{const a=e[this.rowKey],s=e[this.colKey],i=parseFloat(e[this.valKey]);t[a]||(t[a]={label:a,definition:e.definition||""}),t[a][s]=(t[a][s]||0)+(isNaN(i)?0:i)})),Object.values(t)},rowDataWithTotal(){const t=this.rowData;if(t.some((t=>"åˆè®¡"===t.label)))return t;const e={label:"åˆè®¡",definition:""};return this.columns.forEach((a=>{e[a]=t.reduce(((t,e)=>{const s=parseFloat(e[a]);return t+(isNaN(s)?0:s)}),0)})),[...t,e]}},methods:{formatNumber(t){const e=parseFloat(t);return isNaN(e)?"-":e.toLocaleString(void 0,{minimumFractionDigits:2})}}}),Oe=Fe,je=(0,l.A)(Oe,Le,Ae,!1,null,"5296a84f",null),$e=je.exports,qe={name:"LChartRow",components:{ComboBarLineChart:de,ComboTable:ge,GroupedBarChart:we,SubjectTable:ke,TransposedTable:$e},props:{filters:{type:Object,required:!0}},computed:{filteredSubjectNames(){return console.log("ğŸ“Œ subjectTables:",this.subjectTables),this.subjectNames.filter((t=>{const e=this.subjectTables[t];return Array.isArray(e?.count)&&e.count.length>0}))}},data(){return{comboData:{barSeries:[],lineSeries:[],tableRows:[],tableColumns:[]},groupedSubjectData:{countSeries:[],sumSeries:[]},subjectTables:{},groupedCharts:{},controlData:{original:[],classified:[]},subjectNames:["æ— å½¢èµ„äº§","å¼€å‘æ”¯å‡º","å­˜è´§"],groupedFields:[{field:"æ‰€å±è¯åˆ¸è¡Œä¸šåˆ†å¸ƒ",displayKey:"æ‰€å±è¯åˆ¸è¡Œä¸šåˆ†å¸ƒ",title:"æ‰€å±è¯åˆ¸è¡Œä¸šåˆ†å¸ƒ"},{field:"å¸‚å€¼è§„æ¨¡",displayKey:"å¸‚å€¼è§„æ¨¡",title:"å¸‚å€¼è§„æ¨¡åˆ†å¸ƒ"},{field:"çœä»½",displayKey:"çœä»½",title:"çœä»½åˆ†å¸ƒ"},{field:"å®æ§äºº",displayKey:"å®æ§äºº",title:"å®æ§äººåˆ†å¸ƒ"}]}},watch:{filters:{handler(){this.loadAllData()},deep:!0,immediate:!0}},methods:{formatToGroupedSeries(t,e=["Q1","Q2","Q3","Q4"]){const a={};return t.forEach((({name:t,"æŠ¥å‘Šæ—¶é—´":s,value:i})=>{a[t]||(a[t]=Array(e.length).fill(0));const r=e.indexOf(s);-1!==r&&(a[t][r]=parseFloat(i))})),Object.entries(a).map((([t,e])=>({name:t,data:e})))},flattenClassified(t){const e=[];return t.forEach((t=>{const{name:a,definition:s,...i}=t;Object.keys(i).forEach((t=>{e.push({name:a,definition:s,"æŠ¥å‘Šæ—¶é—´":t,value:i[t]})}))})),e},async loadAllData(){console.log("âœ… subjectTables keys:",Object.keys(this.subjectTables)),console.log("âœ… groupedSubjectData.countSeries:",this.groupedSubjectData.countSeries),console.log("âœ… groupedSubjectData.sumSeries:",this.groupedSubjectData.sumSeries);try{const[t,e,a,...s]=await Promise.all([m.A.post("/api/lchart/combo1",{filters:this.filters}),m.A.post("/api/lchart/subject-bars",{filters:this.filters}),m.A.post("/api/lchart/subject-tables",{filters:this.filters}),...this.groupedFields.map((t=>m.A.post("/api/lchart/group-field",{filters:this.filters,field:t.field})))]),i=t.data.barSeries||[],r=t.data.lineSeries||[];this.comboData.barSeries=[{name:"æ•°æ®èµ„æºå…¥è¡¨æ•°é‡",data:i.map((t=>t["æ•°æ®èµ„æºå…¥è¡¨æ•°é‡"]))}],this.comboData.lineSeries={name:"æ•°æ®èµ„æºå…¥è¡¨æ€»é¢",data:r.map((t=>t["æ•°æ®èµ„æºå…¥è¡¨æ€»é¢ï¼ˆå•ä½ï¼šä¸‡å…ƒï¼‰"]))},this.comboData.categories=i.map((t=>t["æŠ¥å‘Šæ—¶é—´"]));const n={};r.forEach((t=>{n[t["æŠ¥å‘Šæ—¶é—´"]]=t["æ•°æ®èµ„æºå…¥è¡¨æ€»é¢ï¼ˆå•ä½ï¼šä¸‡å…ƒï¼‰"]})),this.comboData.tableRows=i.map((t=>({"æŠ¥å‘Šæ—¶é—´":t["æŠ¥å‘Šæ—¶é—´"],"å…¥è¡¨æ•°é‡":t["æ•°æ®èµ„æºå…¥è¡¨æ•°é‡"],"å…¥è¡¨æ€»é¢ï¼ˆä¸‡å…ƒï¼‰":n[t["æŠ¥å‘Šæ—¶é—´"]]||0}))),this.comboData.tableColumns=["æŠ¥å‘Šæ—¶é—´","å…¥è¡¨æ•°é‡","å…¥è¡¨æ€»é¢ï¼ˆä¸‡å…ƒï¼‰"],this.groupedSubjectData=e.data,this.subjectTables=a.data,this.groupedFields.forEach(((t,e)=>{const a=s[e].data,i=a.map((t=>({...t,value:parseFloat(t.value)})));this.groupedCharts[t.field]=i}));const o=await m.A.post("/api/lchart/control-summary",{filters:this.filters});this.controlData=o.data}catch(t){console.error("âŒ åŠ è½½å›¾è¡¨æ•°æ®å¤±è´¥",t)}}}},Ne=qe,Re=(0,l.A)(Ne,se,ie,!1,null,"55274176",null),Me=Re.exports,Ee={name:"LSDashboardPage",components:{LFilterSection:ae,LChartRow:Me,LoadingSpinner:P},data(){return{isLoading:!0,filters:{province_area:"",quarter:""}}},methods:{onFilterUpdate(t){this.filters={...this.filters,...t},this.isLoading=!1}},mounted(){setTimeout((()=>{this.isLoading=!1}),600)}},Qe=Ee,Be=(0,l.A)(Qe,Wt,Yt,!1,null,"90b43920",null),Ke=Be.exports,ze=function(){var t=this,e=t._self._c;return e("div",{staticClass:"admin-container"},[e("aside",{class:["sidebar",{collapsed:t.isSidebarCollapsed}]},[t.isSidebarCollapsed?t._e():e("div",{staticClass:"sidebar-title"},[t._v(" æ•°æ®æ˜ç»†ç®¡ç† "),e("button",{staticClass:"collapse-btn",on:{click:t.toggleSidebar}},[t._v("â—€")])]),t.isSidebarCollapsed?t._e():e("nav",{staticClass:"menu"},[e("div",{staticClass:"menu-item",class:{active:"listed"===t.currentTab},on:{click:function(e){return t.switchTab("listed")}}},[t._v(" ä¸Šå¸‚å…¬å¸æ•°æ® ")]),e("div",{staticClass:"menu-item",class:{active:"nonlisted"===t.currentTab},on:{click:function(e){return t.switchTab("nonlisted")}}},[t._v(" éä¸Šå¸‚å…¬å¸æ•°æ® ")]),e("div",{staticClass:"menu-item",class:{active:t.isFinanceTab}},[t._v(" æ•°æ®èµ„äº§èèµ„ ")]),e("div",{staticClass:"menu-subitem",class:{active:"finance-bank"===t.currentTab},on:{click:function(e){return t.switchTab("finance-bank")}}},[t._v(" æ•°æ®èµ„äº§å¢ä¿¡é“¶è¡Œè´·æ¬¾ ")]),e("div",{staticClass:"menu-subitem",class:{active:"finance-stock"===t.currentTab},on:{click:function(e){return t.switchTab("finance-stock")}}},[t._v(" æ•°æ®èµ„äº§ä½œä»·å…¥è‚¡ ")]),e("div",{staticClass:"menu-subitem",class:{active:"finance-other"===t.currentTab},on:{click:function(e){return t.switchTab("finance-other")}}},[t._v(" å…¶ä»–æ•°æ®ç±»èèµ„ ")])])]),t.isSidebarCollapsed?e("button",{staticClass:"expand-btn",on:{click:t.toggleSidebar}},[t._v("â–¶")]):t._e(),e("main",{staticClass:"content"},[e("h1",{staticClass:"content-title"},[t._v(t._s("listed"===t.currentTab?"ä¸Šå¸‚å…¬å¸æ•°æ®":"éä¸Šå¸‚å…¬å¸æ•°æ®"))]),e("p",{staticClass:"update-time"},[t._v("ä¸Šæ¬¡æ›´æ–°æ—¶é—´ï¼š"+t._s(t.lastUpdate))]),e("div",{staticClass:"search-bar"},[e("button",{staticClass:"clear-all-btn",on:{click:t.clearAllFilters}},[t._v("æ¸…ç©ºå…¨éƒ¨ç­›é€‰")]),e("label",[t._v("å…³é”®è¯æ£€ç´¢ï¼š")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.searchKeyword,expression:"searchKeyword"}],attrs:{placeholder:"è¯·è¾“å…¥å…³é”®è¯..."},domProps:{value:t.searchKeyword},on:{input:[function(e){e.target.composing||(t.searchKeyword=e.target.value)},t.handleSearch]}})]),t.pagedData.length>0?e("div",{staticClass:"table-wrapper"},[e("table",{staticClass:"data-table"},[e("thead",[e("tr",[e("th",[t._v("åºå·")]),t._v(" "),t._l(t.tableHeaders.filter((t=>"id"!==t)),(function(a){return e("th",{key:a,staticStyle:{position:"relative"}},[e("div",{staticClass:"th-wrapper"},[t._v(" "+t._s(a)+" "),e("span",{staticClass:"filter-icon",attrs:{"data-filter-icon":a},on:{click:function(e){return e.stopPropagation(),t.toggleFilterDropdown(a)}}},[t._v("â·")]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.showFilterDropdown[a],expression:"showFilterDropdown[col]"}],staticClass:"filter-dropdown",attrs:{"data-dropdown":a},on:{click:function(t){t.stopPropagation()}}},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.filterSearch[a],expression:"filterSearch[col]"}],staticClass:"filter-search-input",attrs:{placeholder:"æœç´¢è¯¥åˆ—..."},domProps:{value:t.filterSearch[a]},on:{input:function(e){e.target.composing||t.$set(t.filterSearch,a,e.target.value)}}}),e("div",{staticClass:"filter-options"},t._l(t.getFilteredOptions(a),(function(s){return e("label",{key:s},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.pendingFilters[a],expression:"pendingFilters[col]"}],attrs:{type:"checkbox"},domProps:{value:s,checked:Array.isArray(t.pendingFilters[a])?t._i(t.pendingFilters[a],s)>-1:t.pendingFilters[a]},on:{change:function(e){var i=t.pendingFilters[a],r=e.target,n=!!r.checked;if(Array.isArray(i)){var o=s,l=t._i(i,o);r.checked?l<0&&t.$set(t.pendingFilters,a,i.concat([o])):l>-1&&t.$set(t.pendingFilters,a,i.slice(0,l).concat(i.slice(l+1)))}else t.$set(t.pendingFilters,a,n)}}}),t._v(" "+t._s(s)+" ")])})),0),e("div",{staticClass:"filter-footer"},[e("button",{on:{click:function(e){return t.clearFilter(a)}}},[t._v("æ¸…ç©ºç­›é€‰")]),e("button",{on:{click:function(e){return t.confirmFilter(a)}}},[t._v("ç¡®å®š")])])])])])}))],2)]),e("tbody",t._l(t.pagedData,(function(a,s){return e("tr",{key:s,class:t.getRowClass(a)},[e("td",{on:{click:function(e){return t.toggleRowState(a)}}},[e("div",{staticStyle:{display:"flex","align-items":"center",gap:"6px"}},[e("span",[t._v(t._s((t.currentPage-1)*t.pageSize+s+1))]),t.getRowButton(a)?e("button",{staticClass:"row-status-btn",class:t.getRowButton(a)?.color},[t._v(" "+t._s(t.getRowButton(a)?.label)+" ")]):t._e()])]),t._l(a,(function(s,i){return e("td",{directives:[{name:"show",rawName:"v-show",value:"id"!==i,expression:"key !== 'id'"}],key:i,class:t.getCellClass(a,i)},[t.isCellChanged(a,i)?e("button",{staticClass:"cell-status-btn red",on:{click:function(e){return t.toggleCellState(a,i)}}},[t._v(" "+t._s(t.getCellStatusLabel(a,i))+" ")]):t._e(),e("span",{domProps:{innerHTML:t._s(t.highlight(s,i))}})])}))],2)})),0)])]):e("p",{staticClass:"no-data"},[t._v("æš‚æ— æ•°æ®")]),t.totalPages>1?e("div",{staticClass:"pagination"},[t.currentPage>1?e("button",{on:{click:function(e){return t.changePage(t.currentPage-1)}}},[t._v("ä¸Šä¸€é¡µ")]):t._e(),e("span",{staticClass:"page-info"},[t._v(t._s(t.currentPage)+" / "+t._s(t.totalPages))]),t.currentPage<t.totalPages?e("button",{on:{click:function(e){return t.changePage(t.currentPage+1)}}},[t._v("ä¸‹ä¸€é¡µ")]):t._e()]):t._e(),e("div",{staticClass:"export-controls"},[e("label",{staticClass:"upload-btn"},[t._v(" ä¸Šä¼ æ•°æ® "),e("input",{attrs:{type:"file",accept:".xlsx",hidden:""},on:{change:t.handleUpload}})]),e("button",{staticClass:"export-btn",on:{click:t.exportExcel}},[t._v("å¯¼å‡º Excel")])])])])},Ge=[],Ve=(a(1148),a(116),{name:"AdminPage",data(){return{currentTab:"listed",tableData:[],tableHeaders:[],lastUpdate:"",currentPage:1,pageSize:15,isSidebarCollapsed:!1,filters:{},pendingFilters:{},filterSearch:{},uniqueColumnValues:{},searchKeyword:"",showFilterDropdown:{},rowStatus:{}}},computed:{filteredData(){return this.tableData.filter((t=>Object.keys(this.filters).every((e=>{const a=this.filters[e];return!a||0===a.length||a.includes(t[e])}))))},searchedData(){if(!this.searchKeyword)return this.filteredData;const t=this.searchKeyword.toLowerCase();return this.filteredData.filter((e=>Object.values(e).some((e=>String(e).toLowerCase().includes(t)))))},pagedData(){const t=(this.currentPage-1)*this.pageSize,e=this.currentPage*this.pageSize;return this.searchedData.slice(t,e)},totalPages(){return Math.max(1,Math.ceil(this.searchedData.length/this.pageSize))},isFinanceTab(){return["finance-bank","finance-stock","finance-other"].includes(this.currentTab)}},methods:{getRowKey(t){return`${t.company_name}_${t.year_month}`},getRowClass(t){const e=this.rowStatus[this.getRowKey(t)];return"deleted"===e?.rowState?"row-deleted":""},getRowButton(t){const e=this.rowStatus[this.getRowKey(t)];if(!e||!e.changed?.length)return null;const a=e.rowState||"active";return{label:"deleted"===a?"åˆ é™¤":"å˜åŠ¨",color:"deleted"===a?"red":"blue"}},toggleRowState(t){const e=this.getRowKey(t),a=this.rowStatus[e],s="deleted"===a?.rowState?"active":"deleted";a&&this.$set(a,"rowState",s)},isCellChanged(t,e){const a=this.getRowKey(t);return this.rowStatus[a]?.changed?.includes(e)},getCellClass(t,e){return this.isCellChanged(t,e)?"cell-changed":""},toggleCellState(t,e){const a=this.getRowKey(t);this.rowStatus[a]?.cellState||this.$set(this.rowStatus[a],"cellState",{});const s=this.rowStatus[a].cellState[e],i="deleted"===s?"active":"deleted";this.$set(this.rowStatus[a].cellState,e,i)},getCellStatusLabel(t,e){const a=this.getRowKey(t),s=this.rowStatus[a]?.cellState?.[e];return"deleted"===s?"ä½¿ç”¨":"å˜åŠ¨"},async handleUpload(t){const e=t.target.files[0];if(!e)return;const a=new FormData;a.append("file",e);const s={listed:"dataasset_listed_companies_2024",nonlisted:"dataasset_non_listed_companies","finance-stock":"dataasset_finance_stock","finance-other":"dataasset_finance_other"},i=s[this.currentTab];if(!i)return alert("è¯¥è¡¨ä¸æ”¯æŒä¸Šä¼ ");try{const t=await m.A.post(`/api/upload/append?tableName=${i}`,a,{headers:{"Content-Type":"multipart/form-data"}}),e=t.data?.newRows||[];e.forEach((t=>{const e=this.getRowKey(t),a=this.tableData.find((e=>e.company_name===t.company_name&&e.year_month===t.year_month));if(a){const s=[];Object.keys(t).forEach((e=>{"id"!==e&&t[e]!==a[e]&&s.push(e)})),s.length&&(this.tableData.push({...t}),this.$set(this.rowStatus,e,{changed:s,rowState:"active",cellState:{}}))}else this.tableData.push({...t})}))}catch(r){alert("ä¸Šä¼ å¤±è´¥ï¼š"+(r.response?.data?.error||r.message))}},toggleSidebar(){this.isSidebarCollapsed=!this.isSidebarCollapsed},switchTab(t){this.currentTab=t,this.clearAllFilters(),this.loadData()},async loadData(){try{let t="";"listed"===this.currentTab?t="/api/company/listed-companies-detail":"nonlisted"===this.currentTab?t="/api/company/non-listed-companies-detail":"finance-bank"===this.currentTab?t="/api/finance/bank-detail":"finance-stock"===this.currentTab?t="/api/dataTable/dataasset_finance_stock/page?page=1&pageSize=1000":"finance-other"===this.currentTab&&(t="/api/dataTable/dataasset_finance_other/page?page=1&pageSize=1000");const e=await m.A.get(t),a=e.data?.rows||e.data||[];this.tableData=a,this.tableHeaders=a.length>0?Object.keys(a[0]):[];const s={};a.forEach((t=>{for(const e in t)s[e]||(s[e]=new Set),null!==t[e]&&""!==t[e]&&s[e].add(t[e])})),this.uniqueColumnValues=Object.fromEntries(Object.entries(s).map((([t,e])=>[t,Array.from(e)])));const i=new Date;this.lastUpdate=`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}-${String(i.getDate()).padStart(2,"0")} ${String(i.getHours()).padStart(2,"0")}:${String(i.getMinutes()).padStart(2,"0")}:${String(i.getSeconds()).padStart(2,"0")}`}catch(t){console.error("æ•°æ®åŠ è½½å¤±è´¥ï¼š",t),this.tableData=[],this.tableHeaders=[]}},clearAllFilters(){this.filters={},this.pendingFilters={},this.filterSearch={},this.searchKeyword="",this.currentPage=1},toggleFilterDropdown(t){this.closeAllDropdowns(),this.$set(this.showFilterDropdown,t,!0),this.$set(this.pendingFilters,t,[...this.filters[t]||[]]),this.$nextTick((()=>{const e=this.$el.querySelector(`[data-filter-icon="${t}"]`),a=this.$el.querySelector(`[data-dropdown="${t}"]`);if(e&&a){const t=e.getBoundingClientRect();a.style.position="fixed",a.style.left=`${t.left-a.offsetWidth+e.offsetWidth}px`,a.style.top=`${t.bottom+4}px`,a.style.zIndex="9999"}}))},confirmFilter(t){this.$set(this.filters,t,[...this.pendingFilters[t]||[]]),this.$set(this.showFilterDropdown,t,!1),this.currentPage=1},clearFilter(t){this.$set(this.pendingFilters,t,[]),this.$set(this.filters,t,[]),this.$set(this.showFilterDropdown,t,!1),this.currentPage=1},closeAllDropdowns(){Object.keys(this.showFilterDropdown).forEach((t=>{this.$set(this.showFilterDropdown,t,!1)}))},handleClickOutside(t){const e=this.$el.querySelectorAll(".filter-dropdown");for(let a of e)if(a.contains(t.target))return;this.closeAllDropdowns()},getFilteredOptions(t){const e=(this.filterSearch[t]||"").toLowerCase();return this.uniqueColumnValues[t].filter((t=>String(t).toLowerCase().includes(e)))},handleSearch(){this.currentPage=1},highlight(t,e){if(!this.searchKeyword||"string"!==typeof t)return t;const a=this.searchKeyword.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),s=new RegExp(`(${a})`,"gi");return t.replace(s,"<mark>$1</mark>")},changePage(t){t<1||t>this.totalPages||(this.currentPage=t)},exportExcel(){const t={listed:"dataasset_listed_companies_2024",nonlisted:"dataasset_non_listed_companies","finance-stock":"dataasset_finance_stock","finance-other":"dataasset_finance_other","finance-bank":""},e=t[this.currentTab];if(!e)return alert("è¯¥è¡¨ä¸æ”¯æŒå¯¼å‡º");window.open(`/api/export/${e}`)}},mounted(){this.loadData(),document.addEventListener("mousedown",this.handleClickOutside)},beforeDestroy(){document.removeEventListener("mousedown",this.handleClickOutside)}}),Ie=Ve,He=(0,l.A)(Ie,ze,Ge,!1,null,"1f3e494f",null),Ue=He.exports;s["default"].use(u.Ay);const We=[{path:"/",name:"HomePage",component:N},{path:"/dashboard",name:"NLSDashboardPage",component:Ut},{path:"/lsdashboard",name:"LSDashboardPage",component:Ke},{path:"/admin-page",name:"AdminPage",component:Ue,beforeEnter:(t,e,a)=>{"true"===localStorage.getItem("adminLoggedIn")?a():a("/")}}];var Ye=new u.Ay({routes:We}),Xe=a(1052),Je=a.n(Xe),Ze=a(688),ta=a(3487);Ze.use([tt.a,ta.a,at.a,it.a,st.a,Z.a]),s["default"].prototype.$echarts=Ze,m.A.defaults.timeout=2e4,s["default"].config.productionTip=!1,s["default"].use(Je()),new s["default"]({router:Ye,render:t=>t(d)}).$mount("#app")},8305:function(t,e,a){t.exports=a.p+"img/header_image.a3ff36e6.jpg"},8547:function(t,e,a){t.exports=a.p+"img/footer_image.680083ad.jpg"}},e={};function a(s){var i=e[s];if(void 0!==i)return i.exports;var r=e[s]={id:s,loaded:!1,exports:{}};return t[s].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}a.m=t,function(){a.amdO={}}(),function(){var t=[];a.O=function(e,s,i,r){if(!s){var n=1/0;for(d=0;d<t.length;d++){s=t[d][0],i=t[d][1],r=t[d][2];for(var o=!0,l=0;l<s.length;l++)(!1&r||n>=r)&&Object.keys(a.O).every((function(t){return a.O[t](s[l])}))?s.splice(l--,1):(o=!1,r<n&&(n=r));if(o){t.splice(d--,1);var c=i();void 0!==c&&(e=c)}}return e}r=r||0;for(var d=t.length;d>0&&t[d-1][2]>r;d--)t[d]=t[d-1];t[d]=[s,i,r]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){var t,e=Object.getPrototypeOf?function(t){return Object.getPrototypeOf(t)}:function(t){return t.__proto__};a.t=function(s,i){if(1&i&&(s=this(s)),8&i)return s;if("object"===typeof s&&s){if(4&i&&s.__esModule)return s;if(16&i&&"function"===typeof s.then)return s}var r=Object.create(null);a.r(r);var n={};t=t||[null,e({}),e([]),e(e)];for(var o=2&i&&s;"object"==typeof o&&!~t.indexOf(o);o=e(o))Object.getOwnPropertyNames(o).forEach((function(t){n[t]=function(){return s[t]}}));return n["default"]=function(){return s},a.d(r,n),r}}(),function(){a.d=function(t,e){for(var s in e)a.o(e,s)&&!a.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})}}(),function(){a.f={},a.e=function(t){return Promise.all(Object.keys(a.f).reduce((function(e,s){return a.f[s](t,e),e}),[]))}}(),function(){a.u=function(t){return"js/"+t+".602cfbc4.js"}}(),function(){a.miniCssF=function(t){}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){var t={},e="data_asset_platform:";a.l=function(s,i,r,n){if(t[s])t[s].push(i);else{var o,l;if(void 0!==r)for(var c=document.getElementsByTagName("script"),d=0;d<c.length;d++){var u=c[d];if(u.getAttribute("src")==s||u.getAttribute("data-webpack")==e+r){o=u;break}}o||(l=!0,o=document.createElement("script"),o.charset="utf-8",o.timeout=120,a.nc&&o.setAttribute("nonce",a.nc),o.setAttribute("data-webpack",e+r),o.src=s),t[s]=[i];var h=function(e,a){o.onerror=o.onload=null,clearTimeout(p);var i=t[s];if(delete t[s],o.parentNode&&o.parentNode.removeChild(o),i&&i.forEach((function(t){return t(a)})),e)return e(a)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=h.bind(null,o.onerror),o.onload=h.bind(null,o.onload),l&&document.head.appendChild(o)}}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){a.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){a.p="/"}(),function(){var t={524:0};a.f.j=function(e,s){var i=a.o(t,e)?t[e]:void 0;if(0!==i)if(i)s.push(i[2]);else{var r=new Promise((function(a,s){i=t[e]=[a,s]}));s.push(i[2]=r);var n=a.p+a.u(e),o=new Error,l=function(s){if(a.o(t,e)&&(i=t[e],0!==i&&(t[e]=void 0),i)){var r=s&&("load"===s.type?"missing":s.type),n=s&&s.target&&s.target.src;o.message="Loading chunk "+e+" failed.\n("+r+": "+n+")",o.name="ChunkLoadError",o.type=r,o.request=n,i[1](o)}};a.l(n,l,"chunk-"+e,e)}},a.O.j=function(e){return 0===t[e]};var e=function(e,s){var i,r,n=s[0],o=s[1],l=s[2],c=0;if(n.some((function(e){return 0!==t[e]}))){for(i in o)a.o(o,i)&&(a.m[i]=o[i]);if(l)var d=l(a)}for(e&&e(s);c<n.length;c++)r=n[c],a.o(t,r)&&t[r]&&t[r][0](),t[r]=0;return a.O(d)},s=self["webpackChunkdata_asset_platform"]=self["webpackChunkdata_asset_platform"]||[];s.forEach(e.bind(null,0)),s.push=e.bind(null,s.push.bind(s))}();var s=a.O(void 0,[504],(function(){return a(4144)}));s=a.O(s)})();
//# sourceMappingURL=app.98cd7edb.js.map